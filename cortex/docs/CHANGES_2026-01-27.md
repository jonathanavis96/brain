# Changes — 2026-01-27

Date: 2026-01-27 00:58:31

## Summary

This entry captures work completed late 2026-01-26 / early 2026-01-27.

- Added a new planning phase to align templates with the canonical Ralph layout `workers/ralph/` (ADR-0001).
- Quarantined and then safely restored local WIP changes via stashes + WIP branches.
- Updated protected hash baselines after approving a change to `workers/ralph/loop.sh`.

## Details

### Planning: Template Drift Alignment (A1)

- Updated `workers/IMPLEMENTATION_PLAN.md` with **Phase 24: Template Drift Alignment (A1)**.
  - Derived from `TEMPLATE_DRIFT_REPORT.md` and `cortex/docs/ADR-0001-canonical-ralph-layout-workers-ralph.md`.
  - Included PR-sized, dependency-ordered task contracts.
  - Included a "Decisions Needed" section with concrete inspection paths + suggested defaults.
  - Followed plan workflow: tasks inserted above marker; marker moved to end.

### Git hygiene: quarantine + restore

- Pushed the clean plan commit to `origin/brain-work`.
- Quarantined existing dirty working tree into an umbrella stash, then split into smaller stashes:
  - artifacts
  - cortex plan/reports
  - templates/workers scripts
- Exported patch files for stashes (`tmp_rovodev_stash_*.patch`).
- Converted the split stashes into WIP branches with commits, pushed to origin.
- Restored WIP changes back into `brain-work` safely.

### Protected file change: `workers/ralph/loop.sh`

- Approved and kept a small observability/header change in `workers/ralph/loop.sh`:
  - Added `# RUNNER: $RUNNER`
  - Added a "single source of truth" model line printed as `# MODEL: ...` using `RESOLVED_MODEL` with fallback to `MODEL_ARG` (default `auto`).
- Updated the protected hash baseline to match:
  - `workers/ralph/.verify/loop.sha256`
- Committed as an isolated protected-hash update (to avoid mixing unrelated changes).

### Templates/workers script WIP restoration

- Committed restoration of related WIP script/template changes as a separate commit:
  - `templates/ralph/PROMPT.md`
  - `templates/ralph/loop.sh`
  - `templates/ralph/cleanup_plan.sh` (new)
  - `workers/ralph/cleanup_plan.sh`

## Commits

- `f60b285` — plan(workers): add Phase 24 template drift alignment (A1)
- `00f80b1` — wip(artifacts): update dashboard and brain metrics
- `4fef277` — wip(cortex): quarantine plan cleanup + drift report + ADR
- `ede3824` — merge: restore WIP artifacts updates
- `1525029` — merge: restore WIP cortex plan+reports
- `a386a2c` — chore(verify): update protected hash for workers/ralph/loop.sh
- `4411217` — wip(ralph): restore templates loop/prompt + cleanup plan

## References

- `TEMPLATE_DRIFT_REPORT.md`
- `cortex/docs/ADR-0001-canonical-ralph-layout-workers-ralph.md`

## Notes

- The umbrella stash used for quarantine was confirmed redundant after restoration and then dropped.
- Split stashes were intentionally retained temporarily for safety.
